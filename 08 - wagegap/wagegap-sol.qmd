---
title: "La mujer en el mercado laboral español"
author: "EC1027 -- Econometría I" 
date: "Curso 2022-2023"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = "")
```

# Preliminares

- Cargue los paquetes R necesarios para usar matrices de covarianzas robustas a heteroscedasticidad y realizar contrastes de hipótesis lineales sobre los parámetros de los modelos de regresión.
    ```{r packages, warning=FALSE, message=FALSE}
library(lmtest)
library(sandwich)
library(car)
    ```


# Datos

- Lea los datos del fichero "esp.csv" y guárdelos en la variable `esp`.
    ```{r}
esp <- read.csv("esp.csv")
    ```

# Transformación de variables

En esta sección se crean nuevas variables variables apartir de las originales del PIAAC y se guardan en la base de datos `esp`.

- Cree la variable `lsalario`.
    ```{r}
esp$lsalario <- log(esp$EARNHR)
    ```

- Cree la variable `asalariado`.
    ```{r}
esp$asalariado <- !is.na(esp$EARNHR)
    ```

- Cree la variable `mujer`.
    ```{r}
esp$mujer <- as.integer(esp$GENDER_R == 2)
    ```

- Cree la variable `educ`.
    ```{r}
esp$educ <- esp$YRSQUAL
    ```

- Cree la variable `activ`.
    ```{r}
esp$activ <- as.integer(esp$C_D05 != 3)
    ```

- Cree la variable `exper`.
    ```{r}
esp$exper <- esp$C_Q09
    ```

- Cree la variable `antig`.
    ```{r}
esp$antig <- 2012 - esp$D_Q05a2
    ```

- Cree la variable `pub`.
    ```{r}
esp$pub <- as.integer(esp$D_Q03 == 2)
    ```

- Cree la variable `ong`.
    ```{r}
esp$ong <- as.integer(esp$D_Q03 == 3)
    ```

- Cree la variable `temp`.
    ```{r}
esp$temp <- as.integer(esp$D_Q09 %in% c(2, 3))
    ```

- Cree la variable `apr`.
    ```{r}
esp$apr <- as.integer(esp$D_Q09 == 4)
    ```

- Cree la variable `otro`.
    ```{r}
esp$otro <- as.integer(esp$D_Q09 %in% c(5, 6))
    ```

- Cree la variable `edad`.
    ```{r}
esp$edad <- esp$AGE_R
    ```

- Cree la variable `hijos`.
    ```{r}
esp$hijos <- as.integer(esp$J_Q03b > 0)
    ```

- Cree la variable `inmigr`.
    ```{r}
esp$inmigr <- as.integer(esp$J_Q04a == 2)
    ```

- Cree la variable `pareja`.
    ```{r}
esp$pareja <- as.integer(esp$J_Q02a == 1)
    ```

# Ecuaciones de salarios

- Cree una nueva base de datos que sólo contenga las observaciones que corresponden a asalariados.
    ```{r}
esp_asal <- subset(esp, asalariado)
    ```

## Brecha salarial no ajustada

- Estime el modelo $\mathrm{(Mod1)}$ por MCO y guarde los resultados de la estimación en la variable `mod1`.
    ```{r}
mod1 <- lm(lsalario ~ mujer, data = esp_asal)
    ```

- Presente los resultados de la estimación. Utilice estadísticos robustos a heteroscedasticidad.
    ```{r}
coeftest(mod1, vcov. = vcovHC)
    ```

- Interprete el parámetro $\beta_1$. Si existe discriminación en contra de las mujeres, ¿qué signo tendrá $\beta_1$?

  De acuerdo con el Modelo 1, la diferencia entre el salario de las mujeres y de los hombres es igual al $100 \beta_1$% del salario de los hombres. Hay discriminación salarial contra las mujeres si el signo de $\beta_1$ es negativo.

- Contraste la existencia de una brecha salarial en contra de la mujer.

  Las estimaciones del Modelo 1 muestra que el salario medio de las mujeres era un 13% inferior al salario de los hombres. La hipótesis de que no existe brecha salarial se puede formular como $H_0: \beta_1 = 0$. La hipótesis alternativa de que hay discriminación salarial en contra de las mujeres sería $H_1: \beta_1 < 0$. El estadístico $t$ para contrastar esta hipótesis es  $-6.14$, valor que cae dentro de la zona de rechazo para $\alpha = 5\%$.

## Brecha salarial ajustada

- Estime el modelo $\mathrm{(Mod2)}$ por MCO y guarde los resultados de la estimación en la variable `mod2`.
    ```{r}
mod2 <- update(mod1, . ~ . + educ + exper + antig +
                 pub + ong  + temp + apr + otro +
                 edad + hijos + inmigr + pareja)
    ```

- Presente los resultados de la estimación. Utilice estadísticos robustos a heteroscedasticidad.
    ```{r}
coeftest(mod2, vcov. = vcovHC)
    ```

- Contraste la significación conjunta de la regresión.
    ```{r}
bhat2 <- coef(mod2)
joint_h0 <- names(bhat2[-1])
lht(mod2, joint_h0, vcov. = vcovHC)
    ```
   El estadístico $F$ robusto a heteroscedasticidad toma un valor
   muy elevado, $F = 107$, y el valor de probabilidad es prácticamente
   $0$, por lo que rechazamos la hipótesis de que todas las
   pendientes del Modelo 2 son iguales a $0$.


- Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.

  El principal parámetro de la ecuación de salarios es $\beta_1$,
  la pendiente de la variable `mujer`. La estimación negativa y
  significativa muestra que, a igualdad de condiciones, el salario
  de las mujeres es un $16\%$ inferior al de los hombres.

  La educación de los trabajadores también es un determinante
  significativo de sus salarios. Las estimaciones
  del Modelo 2 muestran que cada año adicional de educación se
  traduce, en promedio, en un aumento del $6\%$ del salario.

  Los años de experiencia laboral parecen tener un efecto pequeño
  sobre el salario medio (aumento de $0.2\%$ al año) y no significativo.
  Por otro lado, cada año de antigüedad en la empresa eleva el salario
  en casi un $1\%$ siendo significativo este efecto.

  El tipo de empresa en la que se desarrolla la actividad laboral
  influye mucho sobre el salario. Nuestras estimaciones muestran
  que el salario de de las empresas públicas
  es significativamente mayor que el que pagan las empresas privadas
  (un $16.7\%$ mayor). Por el contrario, el salario en las empresas
  sin ánimo de lucro es un $10.8\%$ inferior al de las
  empresas privadas. La precisión de la estimación del parámetro de
  `ong` no es grande y el efecto no es significativo para
  $\alpha = 5\%$.

  El tipo de contrato también ayuda a explicar las diferencias entre
  los salarios de los trabajadores. Los trabajadores con un contrato
  temporal, de aprendizaje u otros tipos de contrato tienen,
  respectivamente, salarios un $4.2\%$, un $21.6\%$ y un $3.9\%$
  inferiores a los trabajadores con un contrato indefinido. Sin embargo,
  solo la diferencia con los salarios de los aprendices es
  significativamente distinta de 0.

  Otras características individuales no tienen efectos significativos al
  $5\%$ sobre los salarios. La variable `edad` tiene un efecto muy pequeño
  (incremento salarial de $0.2\%$ al año), mientras que los efectos de tener
  hijos dependientes a cargo o de convivir con la pareja son
  cuantitativamente similares (un salario un $5\%$ mayor en ambos casos).

  Finalmente, el salario de los trabajadores nacidos fuera de España es
  un $12\%$ inferior al de los españoles, siendo este un efecto fuertemente
  significativo.


- ¿Hay diferencias entre la brecha salarial no ajustada y la ajustada?

  No hay grandes diferencias. La estimación de la  brecha
  salarial del Modelo 2 es un poco mayor que la que se obtuvo
  con el Modelo 1 ($3$ puntos porcentuales). En ambos casos,
  los resultados indican la existencia de una importante brecha
  salarial y las estimaciones son significativamente distintas de 0.

- Obtenga un intervalo de confianza para la brecha salarial ajustada.
    ```{r}
coefci(mod2, parm = "mujer", vcov. = vcovHC)
    ```

  A un nivel de confianza del $95\%$, los salarios medios de las mujeres
  son entre un $12\%$ y un $20\%$ más bajos que los salarios medios de los
  hombres, a igualdad de las variables incluidas en el Modelo 2.

# Participación en el mercado laboral

## Modelo de probabilidad lineal simple


- Estime el modelo $\mathrm{(Mod3)}$ por MCO y guarde los resultados de la estimación en la variable `mod3`.
    ```{r}
mod3 <- lm(activ ~ mujer, data = esp)
    ```

- Presente los resultados de la estimación. Utilice estadísticos robustos a heteroscedasticidad.
    ```{r}
coeftest(mod3, vcov. = vcovHC)
    ```

- ¿Cuál es la interpretación del parámetro $\alpha_1$?

  El parámetro $\alpha_1$ mide la diferencia de las probabilidades
  de estar activo en el mercado laboral de mujeres y hombres.
  Alternativamente, $100 \alpha_1$ es la diferencia en las tasas de
  actividad de mujeres y de hombres.


- ¿Hay diferencias entre las tasas de actividad de hombres y mujeres? ¿Son significativas esas diferencias?

  De acuerdo con las estimaciones del Modelo 3, la tasa de actividad
  de las mujeres es 11 puntos porcentuales menor que la de los hombres.
  y esta diferencia es significativa distinta de 0 a un nivel de
  significación del $5\%$.

## Modelo de probabilidad lineal múltiple

- Estime el modelo $\mathrm{(Mod4)}$ por MCO y guarde los resultados de la estimación en la variable `mod4`.
    ```{r}
mod4 <- lm(activ ~ mujer + educ + exper +
					 	edad + hijos + inmigr + pareja,
					 data = esp)
    ```

- Presente los resultados de la estimación. Utilice estadísticos robustos a heteroscedasticidad.
    ```{r}
coeftest(mod4, vcov. = vcovHC)
    ```

- ¿Hay diferencias entre las estimaciones del  parámetro $\alpha_1$ en el modelo $\mathrm{(Mod3)}$ y en el modelo $\mathrm{(Mod4)}$?

  Sí: una vez se toman en cuenta otras características de los
  trabajadores, la diferencia en las probabilidades de hombres y
  mujeres de participar en el mercado de trabajo se reduce a
  6.6 puntos porcentuales. Aún así, la diferencia sigue siendo
  significativa y se corresponde a una menor participación de las
  mujeres en el mercado laboral.

- Contraste la significación conjunta de la regresión.
    ```{r}
bhat4 <- coef(mod4)
joint_h0 <- names(bhat4[-1])
lht(mod4, joint_h0, vcov. = vcovHC)
    ```

  El estadístico $F$ robusto a heteroscedasticidad toma un valor
  muy elevado, $F = 109$, y el valor de probabilidad es prácticamente
  $0$, por lo que rechazamos la hipótesis de que todas las
  pendientes del Modelo 4 son iguales a $0$.

- Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.

  Todas las variables del Modelo 4, a excepción de `pareja`, tienen un
  efecto significativo al $5\%$ sobre la probabilidad de participar en
  el mercado de trabajo.

  Como se comentó antes, el parámetro de `mujer` muestra que, a igualdad
  de las otras características incluidas en el Modelo 4, las mujeres tienen
  una menor probabilidad de participar en el mercado de trabajo que los
  hombres.

  Tanto `educ` como `exper` tienen un efecto positivo sobre probabilidad
  de estar activo laboralmente. Cada año adicional de educación eleva esa
  probabilidad en $2$ puntos porcentuales mientras que cada año de
  experiencia laboral la eleva en $1.1$ puntos porcentuales. Por el
  contrario, la edad está inversamente relacionada con la participación
  en el mercado laboral y, *ceteris paribus*, la probabilidad de estar
  activo se reduce en $1.8$ puntos porcentuales cada año que pasa.

  Tener hijos dependientes afecta a la situación laboral, siendo la
  probabilidad de estar activo $7.7$ puntos porcentuales más alta
  en el caso de los individuos con hijos a cargo que en el caso de aquellos
  sin hijos.

  La pendiente de `pareja` indica que la participación en el mercado laboral
  de los individuos que conviven con su pareja es $1.5$ puntos porcentuales
  más alta que la de los que no conviven con sus parejas. Como se comentó antes,
  no se puede rechazar la hipótesis de que este parámetro sea
  igual a $0$ para $\alpha = 5\%$.

  Por último, comparada con la de los trabajadores españoles, la tasa de
  actividad de los nacidos fuera de España es $4.1$ puntos porcentuales más
  alta.
