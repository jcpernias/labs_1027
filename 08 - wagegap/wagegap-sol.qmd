---
author: ""
title: "La mujer en el mercado laboral español"
---

## Objetivos

Se estimarán dos modelos de regresión que permitan describir el papel de las mujeres en el mercado laboral de España a principios de la segunda década del siglo XXI. En primer lugar se estimará la magnitud de la **brecha salarial** que padecen las mujeres. En segundo lugar, se examinaran las diferencias en las **tasas de actividad** de hombres y mujeres.

## Datos

Para estudiar la situación de la mujer en el mercado laboral español se utilizarán los datos del proyecto PIAAC de la OCDE. En comparación con otras bases de datos (Encuesta de población activa, Encuesta de estructura salarial), los datos del PIAAC tienen la ventaja de proporcionar información tanto sobre la situación en el mercado laboral de los participantes en el proyecto como sobre los salarios de los que trabajan por cuenta ajena.

### PIAAC

El Programa para la Evaluación Internacional de las Competencias de los Adultos (PIAAC) es una iniciativa de la OCDE para valorar el nivel de conocimientos y el grado y distribución de destrezas de la población adulta a lo largo de su vida laboral, entre los 16 y los 65 años. Esta evaluación se encuadra en un marco comparativo coherente para poder establecer contrastes internacionales.

La [página](https://www.oecd.org/skills/piaac/) de la OCDE del PIAAC contiene mucha información. En concreto, proporciona acceso a:

-   Las [bases de datos públicas](https://www.oecd.org/skills/piaac/data/) en varios formatos.
-   Informes técnicos y los diferentes [informes nacionales](https://www.oecd.org/skills/piaac/country-specific-material.htm).

Los datos para España se recogieron entre septiembre de 2011 y mayo de 2012. El archivo `esp.csv` recopila una pequeña parte de los datos del PIAAC para España. En concreto, contiene las siguientes variables:

-   `GENDER_R`: Person gender.

    | Value | Label  |
    |:-----:|:-------|
    |   1   | Male   |
    |   2   | Female |

    : {tbl-colwidths="\[15,85\]"}

-   `AGE_R`: Person age in years.

-   `EARNHR`: Hourly earnings excluding bonuses for wage and salary earners in euros.

-   `YRSQUAL`: Highest level of education obtained imputed into years of education.

-   `C_D05`: Employment status.

    | Value | Label                  |
    |:-----:|:-----------------------|
    |   1   | Employed               |
    |   2   | Unemployed             |
    |   3   | Out of the labor force |

    : {tbl-colwidths="\[15,85\]"}

-   `C_Q09`: Years of paid work during lifetime.

-   `D_Q03`: Current work: economic sector.

    | Value | Label                                                                                              |
    |:-----------------:|:----------------------------------------------------|
    |   1   | The private sector (for example a company)                                                         |
    |   2   | The public sector (for example the local government or a state school)                             |
    |   3   | A non-profit organisation (for example a charity, professional association or regious organisation |

    : {tbl-colwidths="\[15,85\]"}

-   `D_Q05a2`: Current work: start of work for employer (year).

-   `D_Q09`: Current work: type of contract.

    | Value | Label                                      |
    |:-----:|:-------------------------------------------|
    |   1   | An indefinite contract                     |
    |   2   | A fixed term contract                      |
    |   3   | A temporary employment agency contract     |
    |   4   | An apprenticeship or other training scheme |
    |   5   | No contract                                |
    |   6   | Other                                      |

    : {tbl-colwidths="\[15,85\]"}

-   `J_Q02a`: Living with spouse or partner.

    | Value | Label |
    |:-----:|:------|
    |   1   | Yes   |
    |   2   | No    |

    : {tbl-colwidths="\[15,85\]"}

-   `J_Q03b`: Number of children.

-   `J_Q04a`: Born in country.

    | Value | Label |
    |:-----:|:------|
    |   1   | Yes   |
    |   2   | No    |

    : {tbl-colwidths="\[15,85\]"}

### Lectura de los datos

La función `read.csv` lee los datos contenidos en ficheros con formato CSV. Las variables deben estar separadas por comas y se usa el punto como separador decimal. La instrucción:

```{r}
esp <- read.csv("esp.csv")
```

leerá los datos de `esp.csv` y guardará los resultados en la base de datos `esp`.

### Valores ausentes

La variable `EARNHR` contiene el salario por hora de los individuos que forman la muestra. Sólo los individuos que trabajan por cuenta ajena perciben un salario por lo que la variable `EARNHR` tiene valores ausentes (*missing values*) en las observaciones correspondientes a desempleados, a trabajadores por cuenta propia y a inactivos. En R los valores ausentes se codifican con el símbolo `NA` (*not available*). Podemos averiguar cuantas observaciones ausentes tiene una variable con la función `summary`:

```{r}
summary(esp$EARNHR)
```

En muchas ocasiones, R maneja automáticamente los valores ausentes y no tenemos que hacer nada especial. Por ejemplo, podemos calcular el logaritmo del salario usando la función `log` como hasta ahora:

```{r}
esp$lsalario <- log(esp$EARNHR)
```

La función `log` propaga los valores ausentes que aparecen en la variable original y calcula el logaritmo de las restantes observaciones.

```{r}
summary(esp$lsalario)
```

Aunque generalmente podemos ignorar la presencia de valores ausentes, en ocasiones tendremos que manejarlos explícitamente. Por ejemplo, si tratamos de obtener el salario medio con la función `mean` obtenemos `NA` como resultado:

```{r}
mean(esp$EARNHR)
```

Algunas funciones (`sum`, `mean`, `max`, `var`, etc.) cuentan con el argumento `na.rm` (*NA remove*) con el que es posible ignorar los valores ausentes en los cálculos. Obtenemos el salario medio con la siguiente instrucción:

```{r}
mean(esp$EARNHR, na.rm = TRUE)
```

Para detectar la presencia de valores ausentes se utiliza la función `is.na`. La siguiente instrucción crea la variable lógica `asalariado` que toma el valor `TRUE` para aquellas observaciones en que el salario **no** es un valor ausente:

```{r}
esp$asalariado <- !is.na(esp$EARNHR)
```

### Transformación de los datos

Además de las variables `lsalario` y `asalariado`, hay que crear otras variables en la base de datos `esp`. Estas variables se incluirán posteriormente en los modelos de regresión.

#### Variables demográficas y situación familiar

::: {.callout-note appearance="simple"}
Cree la variable `edad`: edad en años. Coincide con `AGE_R`.
:::

```{r}
esp$edad <- esp$AGE_R
```

::: {.callout-note appearance="simple"}
Cree la variable `mujer`: variable ficticia que toma el valor 1 para las mujeres y 0 para los hombres. Se construye a partir de la variable `GENDER_R`.
:::

```{r}
esp$mujer <- as.integer(esp$GENDER_R == 2)
```

::: {.callout-note appearance="simple"}
Cree la variable `inmigr`: ficticia que toma el valor 1 si el trabajador nació fuera de España. Se construye a partir de `J_Q04a`.
:::

```{r}
esp$inmigr <- as.integer(esp$J_Q04a == 2)
```

::: {.callout-note appearance="simple"}
Cree la variable `hijos`: ficticia que toma el valor 1 si el trabajador tiene hijos dependientes. Se construye a partir de `J_Q03b`.
:::

```{r}
esp$hijos <- as.integer(esp$J_Q03b > 0)
```

::: {.callout-note appearance="simple"}
Cree la variable `pareja`: ficticia que toma el valor 1 si el trabajador convive con su pareja. Se construye a partir de `J_Q02a`.
:::

```{r}
esp$pareja <- as.integer(esp$J_Q02a == 1)
```

#### Nivel educativo

::: {.callout-note appearance="simple"}
Cree la variable `educ`: años de educación. Coincide con la variable `YRSQUAL`.
:::

```{r}
esp$educ <- esp$YRSQUAL
```

#### Situación laboral

::: {.callout-note appearance="simple"}
Cree la variable `activ`: variable ficticia que toma el valor 1 para las personas que pertenecen a la población activa. Se construye a partir de `C_D05`.
:::

```{r}
esp$activ <- as.integer(esp$C_D05 != 3)
```

::: {.callout-note appearance="simple"}
Cree la variable `exper`: años de experiencia laboral. Coincide con `C_Q09`.
:::

```{r}
esp$exper <- esp$C_Q09
```

::: {.callout-note appearance="simple"}
Cree la variable `antig`: años de antigüedad en la empresa. La variable `D_Q05a2` registra el año en que la persona comenzó a trabajar para su actual empresa. Para obtener la antigüedad en el año de la encuesta, 2012, restamos el valor de `D_Q05a2` a 2012.
:::

```{r}
esp$antig <- 2012 - esp$D_Q05a2
```

#### Tipo de empresa

Tipo de empresa para la que trabaja (categoría de referencia: empresa privada):

::: {.callout-note appearance="simple"}
Cree la variable `pub`: ficticia que toma el valor 1 para los trabajadores del sector público. Se construye a partir de `D_Q03`.
:::

```{r}
esp$pub <- as.integer(esp$D_Q03 == 2)
```

::: {.callout-note appearance="simple"}
Cree la variable `ong`: ficticia que toma el valor 1 para los trabajadores de instituciones sin ánimo de lucro. Se construye a partir de `D_Q03`.
:::

```{r}
esp$ong <- as.integer(esp$D_Q03 == 3)
```

#### Tipo de contrato laboral

Tipo de contrato laboral (categoría de referencia: contrato indefinido):

::: {.callout-note appearance="simple"}
Cree la variable `temp`: contrato temporal. Ficticia que toma el valor 1 cuando `D_Q09` es igual a 2 o a 3.
:::

```{r}
esp$temp <- as.integer(esp$D_Q09 == 2 | esp$D_Q09 ==  3)
```

::: {.callout-note appearance="simple"}
Cree la variable `apr`: contrato de aprendizaje. Ficticia que toma el valor 1 cuando `D_Q09` es igual a 4.
:::

```{r}
esp$apr <- as.integer(esp$D_Q09 == 4)
```

::: {.callout-note appearance="simple"}
Cree la variable `otro`: otra situación contractual. Ficticia que toma el valor 1 cuando `D_Q09` es igual a 5 o 6.
:::

```{r}
esp$otro <- as.integer(esp$D_Q09 == 5 | esp$D_Q09 == 6)
```

## Ecuaciones de salarios

En esta sección plantemos la estimación de **ecuaciones de salarios**: modelos econométricos que explican los salarios (usualmente en logaritmos) a partir de características de los trabajadores (cualificación académica, experiencia laboral, etc.) y de su puesto de trabajo (tipo de empresa, tipo de contrato, etc.)

Para la estimación y la inferencia robusta a heteroscedasticidad se necesitan los paquetes `sandwich`, `lmtest` y `car`:

```{r}
#| message: false
#| warning: false

library(sandwich)
library(lmtest)
library(car)
```

Los modelos de esta sección sólo se aplican a las personas que trabajan por cuenta ajena. Construiremos una base de datos que sólo incluya las observaciones correspondientes a asalariados. La función `subset` conserva las observaciones que cumplen una determinada condición y elimina aquellas para las que no se cumple. En nuestro caso utilizaremos la variable `asalariado` para construir la base de datos `esp_asal`:

```{r}
# En la función subset se pueden usar los nombres de las variables sin 
# indicar la base de datos (asalariado en vez de esp$asalariado).
esp_asal <- subset(esp, asalariado == TRUE)
```

::: {.callout-warning appearance="simple"}
En las estimaciones de las ecuaciones de salarios use la base de datos `esp_asal`.
:::

::: {.callout-warning appearance="simple"}
A la hora de estimar por intervalos o realizar contrastes de hipótesis es conveniente usar métodos que sean válidos aun en presencia de heteroscedasticidad.
:::

::: {.callout-warning appearance="simple"}
Utilice un nivel de significación $\alpha = 5\%$ o, equivalentemente, un nivel de confianza $1 - \alpha = 95\%$.
:::

### Brecha salarial no ajustada

La **brecha salarial no ajustada** mide la diferencia entre los salarios percibidos por las mujeres y los percibidos por los hombres sin tener en cuenta ninguna otra característica de los trabajadores. Se estima a partir de un modelo de regresión simple que tiene el logaritmo del salario, `lsalario`, como variable dependiente y `mujer` como variable explicativa: $$
  \mathit{lsalario} = \beta_0 
    + \beta_1 \mathit{mujer} 
    + u 
$$ {#eq-mod1}

::: {.callout-note appearance="simple"}
¿Cuál es la interpretación del parámetro $\beta_1$?
:::

*Respuesta*: De acuerdo con el Modelo 1, la diferencia entre el salario de las mujeres y de los hombres es igual al $100 \beta_1$% del salario de los hombres. Hay discriminación salarial contra las mujeres si el signo de $\beta_1$ es negativo.

::: {.callout-note appearance="simple"}
Estime los parámetros del modelo de la @eq-mod1 y presente una tabla con los resultados de la estimación.
:::

```{r}
mod1 <- lm(lsalario ~ mujer, data = esp_asal)
coeftest(mod1, vcov. = vcovHC)
```

::: {.callout-note appearance="simple"}
Usando los resultados presentados en la tabla de la regresión, contraste la existencia de una brecha salarial en contra de las mujeres.
:::

*Respuesta*: Las estimaciones del Modelo 1 muestra que el salario medio de las mujeres era un 13% inferior al salario de los hombres. La hipótesis de que no existe brecha salarial se puede formular como $H_0: \beta_1 = 0$. La hipótesis alternativa de que hay discriminación salarial en contra de las mujeres sería $H_1: \beta_1 < 0$. El estadístico $t$ para contrastar esta hipótesis es  $-6.14$, valor que cae dentro de la zona de rechazo para $\alpha = 5\%$.

### Brecha salarial ajustada

La **brecha salarial ajustada** tiene en cuenta otras variables que capturan características individuales y del puesto de trabajo. La estimaremos a partir del modelo de regresión múltiple: $$
\begin{aligned}
  \mathit{lsalario} =\, &\beta_0 
    + \beta_1 \mathit{mujer} 
    + \beta_2 \mathit{educ} 
    + \beta_3 \mathit{exper} 
    + \beta_4 \mathit{antig} 
    \, + \\ &\beta_5 \mathit{pub} 
    + \beta_6 \mathit{ong} 
    + \beta_7 \mathit{temp} 
    + \beta_8 \mathit{apr} 
    + \beta_9 \mathit{otro}
    \, + \\ &\beta_{10} \mathit{edad} 
    + \beta_{11} \mathit{hijos} 
    + \beta_{12} \mathit{inmigr} 
    + \beta_{13} \mathit{pareja} 
    + u 
\end{aligned}
$$ {#eq-mod2}

::: {.callout-note appearance="simple"}
Estime los parámetros del modelo de la @eq-mod2 y presente una tabla con los resultados de la estimación.
:::

```{r}
mod2 <- update(mod1, . ~ . + educ + exper + antig +
                 pub + ong  + temp + apr + otro +
                 edad + hijos + inmigr + pareja)
coeftest(mod2, vcov. = vcovHC)
```

::: {.callout-note appearance="simple"}
Contraste la significación conjunta de la regresión.
:::

```{r}
bhat2 <- coef(mod2)
joint_h0 <- names(bhat2[-1])
lht(mod2, joint_h0, vcov. = vcovHC)
```

*Respuesta*: El estadístico $F$ robusto a heteroscedasticidad toma un valor
   muy elevado, $F = 107$, y el valor de probabilidad es prácticamente
   $0$, por lo que rechazamos la hipótesis de que todas las
   pendientes del Modelo 2 son iguales a $0$.

::: {.callout-note appearance="simple"}
Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.
:::

*Respuesta*: El principal parámetro de la ecuación de salarios es $\beta_1$,
  la pendiente de la variable `mujer`. La estimación negativa y
  significativa muestra que, a igualdad de condiciones, el salario
  de las mujeres es un $16\%$ inferior al de los hombres.

  La educación de los trabajadores también es un determinante
  significativo de sus salarios. Las estimaciones
  del Modelo 2 muestran que cada año adicional de educación se
  traduce, en promedio, en un aumento del $6\%$ del salario.

  Los años de experiencia laboral parecen tener un efecto pequeño
  sobre el salario medio (aumento de $0.2\%$ al año) y no significativo.
  Por otro lado, cada año de antigüedad en la empresa eleva el salario
  en casi un $1\%$ siendo significativo este efecto.

  El tipo de empresa en la que se desarrolla la actividad laboral
  influye mucho sobre el salario. Nuestras estimaciones muestran
  que el salario de de las empresas públicas
  es significativamente mayor que el que pagan las empresas privadas
  (un $16.7\%$ mayor). Por el contrario, el salario en las empresas
  sin ánimo de lucro es un $10.8\%$ inferior al de las
  empresas privadas. La precisión de la estimación del parámetro de
  `ong` no es grande y el efecto no es significativo para
  $\alpha = 5\%$.

  El tipo de contrato también ayuda a explicar las diferencias entre
  los salarios de los trabajadores. Los trabajadores con un contrato
  temporal, de aprendizaje u otros tipos de contrato tienen,
  respectivamente, salarios un $4.2\%$, un $21.6\%$ y un $3.9\%$
  inferiores a los trabajadores con un contrato indefinido. Sin embargo,
  solo la diferencia con los salarios de los aprendices es
  significativamente distinta de 0.

  Otras características individuales no tienen efectos significativos al
  $5\%$ sobre los salarios. La variable `edad` tiene un efecto muy pequeño
  (incremento salarial de $0.2\%$ al año), mientras que los efectos de tener
  hijos dependientes a cargo o de convivir con la pareja son
  cuantitativamente similares (un salario un $5\%$ mayor en ambos casos).

  Finalmente, el salario de los trabajadores nacidos fuera de España es
  un $12\%$ inferior al de los españoles, siendo este un efecto fuertemente
  significativo.


::: {.callout-note appearance="simple"}
¿Hay diferencias entre las estimaciones de la brecha salarial no ajustada y de la ajustada?
:::

*Respuesta*: No hay grandes diferencias. La estimación de la  brecha
  salarial del Modelo 2 es un poco mayor que la que se obtuvo
  con el Modelo 1 ($3$ puntos porcentuales). En ambos casos,
  los resultados indican la existencia de una importante brecha
  salarial y las estimaciones son significativamente distintas de 0.


::: {.callout-note appearance="simple"}
Obtenga un intervalo de confianza para la brecha salarial ajustada.
:::

```{r}
coefci(mod2, parm = "mujer", vcov. = vcovHC)
```

*Respuesta*: A un nivel de confianza del $95\%$, los salarios medios de las mujeres
  son entre un $12\%$ y un $20\%$ más bajos que los salarios medios de los
  hombres, a igualdad de las variables incluidas en el Modelo 2.

## Participación en el mercado laboral

En esta sección se estudiará la incorporación de la mujer al mercado de trabajo utilizando modelos lineales de probabilidad donde la variable dependiente es la variable ficticia `activ` que toma el valor 1 para las personas que participan en el mercado de trabajo.

::: {.callout-warning appearance="simple"}
En los modelos de esta sección se utiliza la base de datos completa, `esp`, ya que es necesario usar información tanto de las personas que estén inactivas como de las personas que componen la población activa.
:::

### Modelo de probabilidad lineal simple

Podemos medir diferencias en la tasa de actividad de las mujeres estimando el modelo de regresión simple: $$
  \mathit{activ} = \alpha_0 
    + \alpha_1 \mathit{mujer} 
    + v 
$$ {#eq-mod3}

::: {.callout-note appearance="simple"}
¿Cuál es la interpretación del parámetro $\alpha_1$?
:::

*Respuesta*: El parámetro $\alpha_1$ mide la diferencia de las probabilidades
  de estar activo en el mercado laboral de mujeres y hombres.
  Alternativamente, $100 \alpha_1$ es la diferencia en las tasas de
  actividad de mujeres y de hombres.

::: {.callout-note appearance="simple"}
Estime los parámetros del modelo de la @eq-mod3 y presente una tabla con los resultados de la estimación.
:::

```{r}
mod3 <- lm(activ ~ mujer, data = esp)
coeftest(mod3, vcov. = vcovHC)
```

::: {.callout-note appearance="simple"}
Usando los resultados de la tabla de la regresión, ¿hay diferencias entre las tasas de actividad de hombres y mujeres? ¿Son significativas esas diferencias?
:::

*Respuesta*: De acuerdo con las estimaciones del Modelo 3, la tasa de actividad
  de las mujeres es 11 puntos porcentuales menor que la de los hombres.
  y esta diferencia es significativa distinta de 0 a un nivel de
  significación del $5\%$.

### Modelo de probabilidad lineal múltiple

Añadiremos más variables explicativas a la @eq-mod3: $$
\begin{aligned}
  \mathit{activ} =\, &\alpha_0 
    + \alpha_1 \mathit{mujer} 
    + \alpha_2 \mathit{educ} 
    + \alpha_3 \mathit{exper} 
    \,+\\ & \alpha_4 \mathit{edad} 
    + \alpha_5 \mathit{hijos} 
    + \alpha_6 \mathit{inmigr} 
    + \alpha_7 \mathit{pareja} 
    + v 
\end{aligned}
$$ {#eq-mod4}

::: {.callout-note appearance="simple"}
Estime los parámetros del modelo de la @eq-mod4 y presente una tabla con los resultados de la estimación.
:::

```{r}
mod4 <- lm(activ ~ mujer + educ + exper +
					 	edad + hijos + inmigr + pareja,
					 data = esp)
coeftest(mod4, vcov. = vcovHC)
```

::: {.callout-note appearance="simple"}
¿Hay diferencias entre las estimaciones del parámetro $\alpha_1$ de la @eq-mod3 y la @eq-mod4?
:::

*Respuesta*: Sí: una vez se toman en cuenta otras características de los
  trabajadores, la diferencia en las probabilidades de hombres y
  mujeres de participar en el mercado de trabajo se reduce a
  6.6 puntos porcentuales. Aún así, la diferencia sigue siendo
  significativa y se corresponde a una menor participación de las
  mujeres en el mercado laboral.


::: {.callout-note appearance="simple"}
Contraste la significación conjunta de la regresión.
:::

```{r}
bhat4 <- coef(mod4)
joint_h0 <- names(bhat4[-1])
lht(mod4, joint_h0, vcov. = vcovHC)
```

*Respuesta*: El estadístico $F$ robusto a heteroscedasticidad toma un valor
  muy elevado, $F = 109$, y el valor de probabilidad es prácticamente
  $0$, por lo que rechazamos la hipótesis de que todas las
  pendientes del Modelo 4 son iguales a $0$.

::: {.callout-note appearance="simple"}
Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.
:::

*Respuesta*: Todas las variables del Modelo 4, a excepción de `pareja`, tienen un
  efecto significativo al $5\%$ sobre la probabilidad de participar en
  el mercado de trabajo.

  Como se comentó antes, el parámetro de `mujer` muestra que, a igualdad
  de las otras características incluidas en el Modelo 4, las mujeres tienen
  una menor probabilidad de participar en el mercado de trabajo que los
  hombres.

  Tanto `educ` como `exper` tienen un efecto positivo sobre probabilidad
  de estar activo laboralmente. Cada año adicional de educación eleva esa
  probabilidad en $2$ puntos porcentuales mientras que cada año de
  experiencia laboral la eleva en $1.1$ puntos porcentuales. Por el
  contrario, la edad está inversamente relacionada con la participación
  en el mercado laboral y, *ceteris paribus*, la probabilidad de estar
  activo se reduce en $1.8$ puntos porcentuales cada año que pasa.

  Tener hijos dependientes afecta a la situación laboral, siendo la
  probabilidad de estar activo $7.7$ puntos porcentuales más alta
  en el caso de los individuos con hijos a cargo que en el caso de aquellos
  sin hijos.

  La pendiente de `pareja` indica que la participación en el mercado laboral
  de los individuos que conviven con su pareja es $1.5$ puntos porcentuales
  más alta que la de los que no conviven con sus parejas. Como se comentó antes,
  no se puede rechazar la hipótesis de que este parámetro sea
  igual a $0$ para $\alpha = 5\%$.

  Por último, comparada con la de los trabajadores españoles, la tasa de
  actividad de los nacidos fuera de España es $4.1$ puntos porcentuales más
  alta.

