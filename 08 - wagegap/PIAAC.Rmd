---
title: "La mujer en el mercado laboral español"
author: "EC1027 --- Econometría I"
date: "Curso 2022-2023"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, comment = "")
```

```{r , include=FALSE}
library(tidyverse)
library(kableExtra)
```

# Objetivos

Estimaremos dos modelos de regresión que nos permitan describir el papel de las mujeres en el mercado laboral de España a principios de la segunda década del siglo XXI. En primer lugar estimaremos la **brecha salarial** que padecen las mujeres. En segundo lugar, examinaremos las diferencias en las **tasas de actividad** de hombres y mujeres.

# Datos

Estudiaremos la situación de la mujer en el mercado laboral español utilizando los datos del proyecto PIAAC de la OCDE. Con respecto a otras bases de datos que se usan frecuentemente para estudiar el mercado laboral (Encuesta de población activa, Encuesta de estructura salarial), los datos del PIAAC tienen la ventaja de proporcionar información tanto sobre la situación en el mercado laboral de los participantes en el proyecto como sobre los salarios de los que trabajan por cuenta ajena. 

## PIAAC

El Programa para la Evaluación Internacional de las Competencias de los Adultos (PIAAC) es una iniciativa de la OCDE para valorar el nivel de conocimientos y el grado y distribución de destrezas de la población adulta a lo largo de su vida laboral, entre los 16 y los 65 años. Esta evaluación se encuadra en un marco comparativo coherente para poder establecer contrastes internacionales.

La [página](https://www.oecd.org/skills/piaac/) de la OCDE del PIAAC contiene mucha información. En concreto, proporciona acceso a:

- Las [bases de datos públicas](https://www.oecd.org/skills/piaac/data/) en varios formatos.
- Informes técnicos y los diferentes [informes nacionales](https://www.oecd.org/skills/piaac/country-specific-material.htm).

Los datos para España se recogieron entre septiembre de 2011 y mayo de 2012. El archivo `esp.csv` recopila una pequeña parte de los datos del PIAAC para España. En concreto, contiene las siguientes variables:

- `GENDER_R`: Person gender.
```{r, echo=FALSE}
  tibble(Value = 1:2, Label = c("Male", "Female")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```

- `AGE_R`: Person age - Years.

- `EARNHR`: Hourly earnings excluding bonuses for wage and salary earners - Euros.

- `YRSQUAL`: Highest level of education obtained imputed into years of education.

- `C_D05`: Employment status.
```{r, echo=FALSE}
  tibble(Value = 1:3, 
         Label = c("Employed", "Unemployed", "Out of the labour force")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```

- `C_Q09`: Years of paid work during lifetime.

- `D_Q03`: Current work: economic sector.
```{r, echo=FALSE}
  tibble(Value = 1:3, 
         Label = c("The private sector (for example a company)", 
                   "The public sector (for example the local government or a state school)", 
                   "A non-profit organisation (for example a charity, professional association or religious organisation")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```

- `D_Q05a2`: Current work: start of work for employer - Year.

- `D_Q09`: Current work: type of contract.
```{r, echo=FALSE}
  tibble(Value = 1:6, 
         Label = c("An indefinite contract", 
                   "A fixed term contract", 
                   "A temporary employment agency contract", 
                   "An apprenticeship or other training schemet", 
                   "No contract", 
                   "Other")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```

- `J_Q02a`: Living with spouse or partner.
```{r, echo=FALSE}
  tibble(Value = 1:2, 
         Label = c("Yes", "No")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```

- `J_Q03b`: Number of children.

- `J_Q04a`: Born in country.
```{r, echo=FALSE}
  tibble(Value = 1:2, 
         Label = c("Yes", "No")) |> 
  kbl(align = "cl") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```


## Lectura de los datos

La función `read.csv` lee los datos contenidos en ficheros con formato csv. Por defecto, las variables deben estar separadas por comas y se tiene que usar el punto como separador decimal. Consulte la ayuda de la función `read.csv` para leer archivos que usen otras convenciones (por ejemplo: punto y coma para separar columnas y coma para separar los decimales).

Si el archivo `esp.csv` está en el directorio de trabajo, la instrucción:
```{r}
esp <- read.csv("esp.csv")
```
leerá los datos del documento `esp.csv` y guardará los resultados en la base de datos `esp`.


## Valores ausentes

La variable `EARNHR` contiene el salario por hora de los individuos que forman la muestra. Sólo los individuos que trabajan por cuenta ajena perciben un salario por lo que la variable `EARNHR` tiene valores ausentes (*missing values*) en las observaciones correspondientes a desempleados, a trabajadores por cuenta propia y a inactivos. En R los valores ausentes se codifican con el símbolo `NA` (*not available*). Podemos averiguar cuantas observaciones ausentes tiene una variable con la función `summary`:
```{r}
summary(esp$EARNHR)
```

En muchas ocasiones, R maneja automáticamente los valores ausentes y no tenemos que hacer nada especial. Por ejemplo, podemos calcular el logaritmo del salario usando la función `log` como hasta ahora:
```{r}
esp$lsalario <- log(esp$EARNHR)
```
La función `log` propaga los valores ausentes que aparecen en la variable original y calcula el logaritmo de las restantes observaciones.
```{r}
summary(esp$lsalario)
```


Aunque generalmente podemos ignorar la presencia de valores ausentes, en ocasiones tendremos que manejarlos explícitamente. Por ejemplo, si tratamos de obtener el salario medio con la función `mean` obtenemos `NA` como resultado:
```{r}
mean(esp$EARNHR)
```
Algunas funciones (`sum`, `mean`, `max`, `var`, etc.) cuentan con el argumento `na.rm` (*NA remove*) con el que es posible ignorar los valores ausentes en los cálculos. Obtenemos el salario medio con la siguiente instrucción:
```{r}
mean(esp$EARNHR, na.rm = TRUE)
```
Para detectar la presencia de valores ausentes se utiliza la función `is.na`. La siguiente instrucción crea la variable lógica `asalariado` que toma el valor `TRUE` para aquellas observaciones en que el salario **no** es un valor ausente:
```{r}
esp$asalariado <- !is.na(esp$EARNHR)
```
Podemos observar el efecto de la instrucción anterior examinando algunos de los valores que toman las variables `EARNHR` y `asalariado`:
```{r echo=FALSE}
head(esp[, c("EARNHR", "asalariado")], n = 10)  |> 
  kbl(align = "rr") |> 
  kable_minimal(full_width = FALSE, 
                position = "left",
                font_size = 14) 
```



## Transformación de los datos

Además de las variables `lsalario` y `asalariado` que hemos creado en la subsección anterior, necesitaremos crear más variables que posteriormente utilizaremos en los modelos de regresión.

- `mujer`: variable ficticia que toma el valor 1 para las mujeres y 0 para los hombres. Se construye a partir de la variable `GENDER_R`.

- `educ`: años de educación. Coincide con la variable `YRSQUAL`.

- `activ`: variable ficticia que toma el valor 1 para las personas que pertenecen a la población activa. Se construye a partir de `C_D05`.  
  
- `exper`: años de experiencia laboral. Coincide con `C_Q09`.

- `antig`: años de antigüedad en la empresa. La variable `D_Q05a2` registra el año en que la persona comenzó a trabajar para su actual empresa. Para obtener la antigüedad en el año de la encuesta, 2012, restamos el valor de `D_Q05a2`  a 2012.  
  
- `edad`: edad en años. Coincide con `AGE_R`.

- Tipo de empresa para la que trabaja (categoría de referencia: empresa privada):

  - `pub`: ficticia que toma el valor 1 para los trabajadores del sector público. Se construye a partir de `D_Q03`.

  - `ong`: ficticia que toma el valor 1 para los trabajadores de instituciones sin ánimo de lucro.  Se construye a partir de `D_Q03`.

- Tipo de contrato laboral (categoría de referencia: contrato indefinido):
  - `temp`: contrato temporal. Ficticia que toma el valor 1 cuando `D_Q09` es igual a 2 o  a 3.

  - `apr`: contrato de aprendizaje.  Ficticia que toma el valor 1 cuando `D_Q09` es igual a 4.

  - `otro`: otra situación contractual. Ficticia que toma el valor 1 cuando `D_Q09` es igual a 5 o 6.

- `hijos`: ficticia que toma el valor 1 si el trabajador tiene hijos dependientes. Se construye a partir de `J_Q03b`.

- `inmigr`: ficticia que toma el valor 1 si el trabajador nació fuera de España. Se construye a partir de `J_Q04a`.

- `pareja`: ficticia que toma el valor 1 si el trabajador convive con su pareja. Se construye a partir de `J_Q02a`.


# Ecuaciones de salarios

En esta sección plantemos la estimación de **ecuaciones de salarios**: modelos econométricos que explican los salarios (usualmente en logaritmos) a partir de características de los trabajadores (cualificación académica, experiencia laboral, etc.) y de su puesto de trabajo (tipo de empresa, tipo de contrato, etc.)  

Los modelos de esta sección sólo se aplican a las personas que trabajan por cuenta ajena. Construiremos una base de datos que sólo incluya las observaciones correspondientes a asalariados. La función `subset` conserva las observaciones que cumplen una determinada condición y elimina aquellas para las que no se cumple. En nuestro caso utilizaremos la variable `asalariado` para construir la base de datos `esp_asal`:
```{r}
# No es necesario usar esp$asalariado en la función subset
esp_asal <- subset(esp, asalariado == TRUE)

# Dado que asalariado es una variable lógica podríamos haber
# escrito la instrucción anterior de una forma más simple:
# 
# esp_asal <- subset(esp, asalariado)
```

- *En las estimaciones de las ecuaciones de salarios use `esp_asal`.* 

- A la hora de estimar por intervalos o realizar contrastes de hipótesis es conveniente usar *métodos que sean válidos aun en presencia de heteroscedasticidad*. 

- *Utilice un nivel de significación $\alpha = 5\%$ o, equivalentemente, un nivel de confianza $1 - \alpha = 95\%$.*

## Brecha salarial no ajustada

La **brecha salarial no ajustada** mide la diferencia entre los salarios percibidos por las mujeres y los percibidos por los hombres sin tener en cuenta ninguna otra característica de los trabajadores. La estimamos a partir de un modelo de regresión simple:
$$
  \log(\mathit{salario}) = \beta_0 
    + \beta_1 \mathit{mujer} 
    + u 
    \tag{Mod1}
$$


- ¿Cuál es la interpretación del parámetro $\beta_1$?

- ¿Cómo puede contrastarse la existencia de una brecha salarial en contra de las mujeres?

## Brecha salarial ajustada

La **brecha salarial ajustada** tiene en cuenta otras variables que capturan características individuales y del puesto de trabajo. La estimaremos a partir del modelo de regresión múltiple:
$$
\begin{aligned}
  \log(\mathit{salario}) =\, &\beta_0 
    + \beta_1 \mathit{mujer} 
    + \beta_2 \mathit{educ} 
    + \beta_3 \mathit{exper} 
    + \beta_4 \mathit{antig} 
    \, + \\ &\beta_5 \mathit{pub} 
    + \beta_6 \mathit{ong} 
    + \beta_7 \mathit{temp} 
    + \beta_8 \mathit{apr} 
    + \beta_9 \mathit{otro}
    \, + \\ &\beta_{10} \mathit{edad} 
    + \beta_{11} \mathit{hijos} 
    + \beta_{12} \mathit{inmigr} 
    + \beta_{13} \mathit{pareja} 
    + u 
\end{aligned}
\tag{Mod2}
$$
- ¿Cuál es la interpretación del parámetro $\beta_1$ en el modelo $\mathrm{(Mod2)}$? ¿En qué se diferencia con la interpretación de ese parámetro en el modelo $\mathrm{(Mod1)}$?

- Contraste la significación conjunta de la regresión.

- Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.

- ¿Hay diferencias entre la brecha salarial no ajustada y la ajustada?

- Obtenga un intervalo de confianza para la brecha salarial no ajustada.

# Participación en el mercado de trabajo

En segundo lugar, se estudiará la incorporación de la mujer al mercado de trabajo utilizando modelos lineales de probabilidad donde la variable dependiente es la variable ficticia `activ` que toma el valor 1 para las personas que participan en el mercado de trabajo. 

*En los modelos de esta sección utilizaremos la base de datos completa*, `esp`, ya que necesitamos información tanto de personas que estén inactivas como de personas que pertenezcan a la población activa.

## Modelo de probabilidad lineal simple

Podemos medir diferencias en la tasa de actividad de las mujeres estimando el modelo de regresión simple:
$$
  activ = \alpha_0 
    + \alpha_1 \mathit{mujer} 
    + v 
    \tag{Mod3}
$$

- ¿Cuál es la interpretación del parámetro $\alpha_1$? 

- ¿Hay diferencias entre las tasas de actividad de hombres y mujeres? ¿Son significativas?

## Modelo de probabilidad lineal múltiple

Añadiremos más variables explicativas al modelo $\mathrm{(Mod3)}$:
$$
\begin{aligned}
  activ =\, &\alpha_0 
    + \alpha_1 \mathit{mujer} 
    + \alpha_2 \mathit{educ} 
    + \alpha_3 \mathit{exper} 
    \,+\\ & \alpha_4 \mathit{edad} 
    + \alpha_5 \mathit{hijos} 
    + \alpha_6 \mathit{inmigr} 
    + \alpha_7 \mathit{pareja} 
    + v 
\end{aligned}
    \tag{Mod4}
$$

- ¿Hay diferencias entre las estimaciones del  parámetro $\alpha_1$ en el modelo $\mathrm{(Mod3)}$ y en el modelo $\mathrm{(Mod4)}$? 

- Contraste la significación conjunta de la regresión.

- Discuta brevemente el signo y la magnitud de las estimaciones de los parámetros y la significación de las variables explicativas.

- De acuerdo con las estimaciones del modelo $\mathrm{(Mod4)}$, ¿hay diferencias entre las tasas de actividad de hombres y mujeres? ¿Son significativas?
